<form [formGroup]="profileCompleteForm" *ngIf="profileCompleteForm"
    class="relative p-6 rounded-2xl shadow-xl bg-white dark:bg-gray-900 max-w-lg mx-auto border border-gray-200 dark:border-gray-700 backdrop-blur-md animate-fade-in-smooth transition-all">

    <!-- Close Button -->
    <button type="button" (click)="closeModal()" 
        class="absolute top-3 right-3 text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100 transition">
        <span class="material-icons text-lg">close</span>
    </button>

    <!-- Progress Bar & Message -->
    <div class="relative mb-6">
        <mat-progress-bar mode="determinate" [value]="progress" class="h-2 rounded-full"></mat-progress-bar>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-2 text-center">{{ progressMessage }}</p>
    </div>

    <!-- ðŸ”¹ Dynamic Steps Rendering -->
    <ng-container [ngSwitch]="step">
        
        <!-- Step 1: Headline -->
        <div *ngSwitchCase="1">
            <h3 class="text-lg font-semibold text-blue-700 dark:text-blue-400 mb-3">ðŸ©º Professional Headline</h3>
            <mat-form-field class="w-full" appearance="outline">
                <mat-label>Headline</mat-label>
                <input matInput formControlName="Headline" placeholder="E.g., Cardiologist at XYZ Hospital">
            </mat-form-field>
        </div>

        <!-- Step 2: Summary -->
        <div *ngSwitchCase="2">
            <h3 class="text-lg font-semibold text-indigo-700 dark:text-indigo-400 mb-3">ðŸ“– Professional Summary</h3>
            <mat-form-field class="w-full" appearance="outline">
                <mat-label>Summary</mat-label>
                <textarea matInput formControlName="Summary" placeholder="Briefly describe your background"></textarea>
            </mat-form-field>
        </div>

        <!-- Step 3: Skills & Specialties -->
        <div *ngSwitchCase="3">
            <h3 class="text-lg font-semibold text-green-700 dark:text-green-400 mb-3">ðŸ’‰ Skills & Specialties</h3>
            <mat-form-field class="w-full" appearance="outline">
                <mat-label>Medical Specialties</mat-label>
                <input matInput formControlName="Skills" placeholder="E.g., Surgery, Pediatrics">
            </mat-form-field>
        </div>

        <!-- Step 4: Certifications & Licenses -->
        <div *ngSwitchCase="4">
            <h3 class="text-lg font-semibold text-purple-700 dark:text-purple-400 mb-3">ðŸ“œ Certifications & Licenses</h3>
            <mat-form-field class="w-full" appearance="outline">
                <mat-label>Medical Certifications</mat-label>
                <input matInput formControlName="Certifications" placeholder="E.g., MBBS, MD, Nursing License">
            </mat-form-field>
        </div>
    </ng-container>

    <!-- Navigation Buttons -->
    <div class="flex justify-between mt-6">
        <button mat-stroked-button *ngIf="step > 1" (click)="prevStep()" color="primary">
            <span class="material-icons">arrow_back</span> Back
        </button>

        <button mat-flat-button color="primary" (click)="step === totalSteps ? finishProfile() : nextStep()">
            {{ step === totalSteps ? 'Finish ðŸš€' : 'Next â†’' }}
        </button>
    </div>
</form>

<!-- Success Modal -->
<div *ngIf="openSuccessModal" class="modal-overlay bg-black bg-opacity-50 dark:bg-opacity-70 fixed inset-0 flex items-center justify-center">
    <div class="modal-box bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-xl rounded-lg p-6">
        <h3 class="text-lg font-bold text-green-700 dark:text-green-400">ðŸŽ¯ Profile Completed!</h3>
        <p class="text-gray-600 dark:text-gray-300">Start connecting with healthcare professionals.</p>
        <div class="modal-buttons mt-4 flex justify-end space-x-4">
            <button mat-flat-button color="primary" (click)="closeModal()">Explore Community</button>
            <button mat-stroked-button (click)="closeModal()">Find Jobs</button>
        </div>
    </div>
</div>
